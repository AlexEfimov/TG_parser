# TG_parser Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# Database Configuration (Session 24: PostgreSQL Support)
# =============================================================================

# Database type: 'sqlite' (development) or 'postgresql' (production)
DB_TYPE=sqlite

# --- SQLite Configuration (when DB_TYPE=sqlite) ---
INGESTION_STATE_DB_PATH=ingestion_state.sqlite
RAW_STORAGE_DB_PATH=raw_storage.sqlite
PROCESSING_STORAGE_DB_PATH=processing_storage.sqlite

# --- PostgreSQL Configuration (when DB_TYPE=postgresql) ---
DB_HOST=localhost
DB_PORT=5432
DB_NAME=tg_parser
DB_USER=tg_parser_user
DB_PASSWORD=your_secure_password_here

# --- Connection Pool Settings (PostgreSQL only) ---
DB_POOL_SIZE=5              # Base number of connections
DB_MAX_OVERFLOW=10          # Additional connections when pool exhausted
DB_POOL_TIMEOUT=30          # Timeout to get connection (seconds)
DB_POOL_RECYCLE=3600        # Recycle connections after N seconds (1 hour)
DB_POOL_PRE_PING=true       # Check connection health before use

# =============================================================================
# LLM Configuration
# =============================================================================

# Provider: openai | anthropic | gemini | ollama
LLM_PROVIDER=openai

# Optional: override default model for provider
# LLM_MODEL=gpt-4o-mini

# Optional: custom base URL (for OpenAI-compatible proxies or Ollama)
# LLM_BASE_URL=http://localhost:11434

# API Keys (at least one required)
OPENAI_API_KEY=sk-...
# ANTHROPIC_API_KEY=sk-ant-...
# GEMINI_API_KEY=AI...
# GOOGLE_API_KEY=AI...  # Alias for GEMINI_API_KEY

# LLM Parameters
LLM_TEMPERATURE=0.0
LLM_MAX_TOKENS=4096

# GPT-5 / Responses API Configuration
LLM_REASONING_EFFORT=low    # minimal | low | medium | high
LLM_VERBOSITY=low           # low | medium | high

# =============================================================================
# Telegram Configuration
# =============================================================================

TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=abcdef1234567890abcdef1234567890
TELEGRAM_PHONE=+1234567890
TELEGRAM_SESSION_NAME=tg_parser_session

# =============================================================================
# Processing Configuration
# =============================================================================

# Retry settings per message
PROCESSING_MAX_ATTEMPTS_PER_MESSAGE=3
PROCESSING_RETRY_BACKOFF_BASE=1.0
PROCESSING_RETRY_JITTER_MAX=0.3

# =============================================================================
# Ingestion Configuration
# =============================================================================

# Retry settings per run
INGESTION_MAX_ATTEMPTS_PER_RUN=5
INGESTION_RETRY_BACKOFF_BASE=1.0
INGESTION_RETRY_JITTER_MAX=0.3

# =============================================================================
# Topicization Configuration
# =============================================================================

TOPICIZATION_TOP_N_ANCHORS=3
TOPICIZATION_SINGLETON_MIN_LEN=300
TOPICIZATION_SINGLETON_MIN_SCORE=0.75
TOPICIZATION_CLUSTER_MIN_ANCHOR_SCORE=0.6
TOPICIZATION_SUPPORTING_MIN_SCORE=0.5

# =============================================================================
# Output Configuration
# =============================================================================

OUTPUT_DIR=output
PROMPTS_DIR=prompts

# =============================================================================
# API Security (Phase 2F)
# =============================================================================

API_KEY_REQUIRED=false
# API_KEYS={"key1":"client1","key2":"client2"}

# =============================================================================
# Rate Limiting (Phase 2F)
# =============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_PROCESS=10/minute
RATE_LIMIT_EXPORT=20/minute
RATE_LIMIT_DEFAULT=100/minute

# =============================================================================
# CORS Configuration (Phase 2F)
# =============================================================================

# CORS_ORIGINS=["http://localhost:3000","https://yourdomain.com"]

# =============================================================================
# Webhooks (Phase 2F)
# =============================================================================

WEBHOOK_TIMEOUT=30.0
WEBHOOK_MAX_RETRIES=3

# =============================================================================
# Agent Configuration (Phase 3B)
# =============================================================================

AGENT_PERSISTENCE_ENABLED=true
AGENT_RETENTION_DAYS=14
AGENT_RETENTION_MODE=delete  # delete | export
AGENT_ARCHIVE_PATH=data/archive/task_history
AGENT_STATS_ENABLED=true

# =============================================================================
# Observability (Phase 3D)
# =============================================================================

# Metrics
METRICS_ENABLED=true

# Scheduler
SCHEDULER_ENABLED=true
SCHEDULER_CLEANUP_INTERVAL_HOURS=24
SCHEDULER_HEALTH_CHECK_INTERVAL_MINUTES=5

# =============================================================================
# Logging (Session 23)
# =============================================================================

LOG_FORMAT=text     # text (development) | json (production)
LOG_LEVEL=INFO      # DEBUG | INFO | WARNING | ERROR | CRITICAL

# =============================================================================
# Retry Configuration (Session 22)
# =============================================================================

RETRY_MAX_ATTEMPTS=3
RETRY_BACKOFF_BASE=1.0
RETRY_BACKOFF_MAX=60.0
RETRY_JITTER=0.3

# =============================================================================
# Ollama Configuration (for local LLM)
# =============================================================================

OLLAMA_BASE_URL=http://localhost:11434

