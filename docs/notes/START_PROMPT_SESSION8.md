# –°—Ç–∞—Ä—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Testing Agent Session 8

–ü—Ä–∏–≤–µ—Ç! –¢—ã –∞–≥–µ–Ω—Ç-—Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ TG_parser. –¢–≤–æ—è —Ä–æ–ª—å ‚Äî –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º Telegram –∫–∞–Ω–∞–ª–µ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏.

## üìç –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**–°—Ç–∞—Ç—É—Å**: Full MVP + –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ ‚úÖ  
**–ü–æ—Å–ª–µ–¥–Ω—è—è —Å–µ—Å—Å–∏—è**: Implementation Agent Session 7 (–∑–∞–≤–µ—Ä—à–µ–Ω–∞)  
**Git**: 17 –∫–æ–º–º–∏—Ç–æ–≤ –≤–ø–µ—Ä–µ–¥–∏ origin/main, working tree clean  
**–¢–µ—Å—Ç—ã**: 85/85 –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ warnings

### ‚úÖ –ß—Ç–æ –£–ñ–ï —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å mock):

- **Ingestion (Telethon)**: —Å–±–æ—Ä raw —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram ‚úÖ
- **Processing (OpenAI)**: raw ‚Üí ProcessedDocument ‚úÖ
- **Topicization**: ProcessedDocument ‚Üí TopicCard + TopicBundle ‚úÖ
- **Export**: KB entries + topics.json + topic_<id>.json ‚úÖ
- **CLI –∫–æ–º–∞–Ω–¥–∞ `run`**: one-shot pipeline (ingest ‚Üí process ‚Üí topicize ‚Üí export) ‚úÖ
- **E2E Tests**: 7 —Ç–µ—Å—Ç–æ–≤ —Å mock Telegram API ‚úÖ

### üéØ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (—Å —Ä–µ–∞–ª—å–Ω—ã–º Telegram):

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Telethon** ‚Äî –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫, –≤–≤–æ–¥ –∫–æ–¥–∞
2. **–°–±–æ—Ä –ø–æ—Å—Ç–æ–≤** ‚Äî get_messages() –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∫–∞–Ω–∞–ª–µ
3. **–°–±–æ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤** ‚Äî get_comments() –¥–ª—è –ø–æ—Å—Ç–æ–≤ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
4. **–ü–æ–ª–Ω—ã–π pipeline** ‚Äî –∫–æ–º–∞–Ω–¥–∞ `run` –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞
5. **Incremental —Ä–µ–∂–∏–º** ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–æ–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã

---

## üìö –ì–¥–µ –Ω–∞–π—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–π –ü–ï–†–í–´–ú:

1. **`docs/notes/SESSION_HANDOFF.md`** (700+ —Å—Ç—Ä–æ–∫)
   - –ü–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
   - –ö–ª—é—á–µ–≤—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (TR-8, TR-22, TR-41, TR-IF-4, TR-63)

2. **`README.md`** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - Quick Start
   - –í—Å–µ CLI –∫–æ–º–∞–Ω–¥—ã
   - Troubleshooting

3. **`.env.example`** ‚Äî –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------|----------|
| Telethon Client | `tg_parser/ingestion/telegram/telethon_client.py` | –°–±–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π |
| Ingestion Orchestrator | `tg_parser/ingestion/orchestrator.py` | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è + retry |
| Processing Pipeline | `tg_parser/processing/pipeline.py` | LLM –æ–±—Ä–∞–±–æ—Ç–∫–∞ |
| Topicization | `tg_parser/processing/topicization.py` | –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è |
| CLI run | `tg_parser/cli/run_cmd.py` | One-shot pipeline |
| Settings | `tg_parser/config/settings.py` | –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |

---

## üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram API credentials

1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://my.telegram.org
2. –í–æ–π–¥–∏ –ø–æ–¥ —Å–≤–æ–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º Telegram
3. –ù–∞–∂–º–∏ "API development tools"
4. –°–æ–∑–¥–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ª—é–±–æ–µ –∏–º—è)
5. –°–∫–æ–ø–∏—Ä—É–π `api_id` –∏ `api_hash`

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ OpenAI API key

1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://platform.openai.com/api-keys
2. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π API key
3. –°–∫–æ–ø–∏—Ä—É–π –∫–ª—é—á

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞

```bash
cd /Users/alexanderefimov/TG_parser
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.env`:

```env
# Telegram API (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)
TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=abcdef1234567890abcdef1234567890
TELEGRAM_PHONE=+79001234567

# OpenAI API (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)
OPENAI_API_KEY=sk-your-api-key-here
```

### 4. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cd /Users/alexanderefimov/TG_parser
source .venv/bin/activate
```

---

## üß™ –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–±–µ–∑ Telegram)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
python -m tg_parser.cli --help
python -m tg_parser.cli run --help

# –ó–∞–ø—É—Å—Ç–∏—Ç—å unit/integration —Ç–µ—Å—Ç—ã
pytest

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å lint
ruff check .
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ —Å Telegram (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
python -m tg_parser.cli init

# –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª (–ø—É–±–ª–∏—á–Ω—ã–π –∫–∞–Ω–∞–ª –¥–ª—è —Ç–µ—Å—Ç–∞)
python -m tg_parser.cli add-source --source-id test_channel --channel-id @durov

# –ü–æ–ø—ã—Ç–∫–∞ ingestion (–∑–¥–µ—Å—å –±—É–¥–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
python -m tg_parser.cli ingest --source test_channel --limit 5
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ Telethon –ø–æ–ø—Ä–æ—Å–∏—Ç:
1. –í–≤–µ—Å—Ç–∏ –∫–æ–¥ –∏–∑ Telegram
2. –í–æ–∑–º–æ–∂–Ω–æ, –ø–∞—Ä–æ–ª—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª–Ω—ã–π pipeline –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –∫–∞–Ω–∞–ª–µ

```bash
# One-shot pipeline —Å –ª–∏–º–∏—Ç–æ–º
python -m tg_parser.cli run --source test_channel --out ./output --limit 10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
ls -la ./output/
cat ./output/kb_entries.ndjson | head -1 | python -m json.tool
cat ./output/topics.json | python -m json.tool
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: Incremental —Ä–µ–∂–∏–º

```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (snapshot)
python -m tg_parser.cli run --source my_channel --out ./output --mode snapshot --limit 20

# –ü–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤...

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫ (incremental) - –¥–æ–ª–∂–µ–Ω —Å–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ
python -m tg_parser.cli run --source my_channel --out ./output --mode incremental
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ö–∞–Ω–∞–ª —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏

```bash
# –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
python -m tg_parser.cli add-source --source-id comments_test --channel-id @some_channel --include-comments

# –ó–∞–ø—É—Å—Ç–∏—Ç—å ingestion
python -m tg_parser.cli ingest --source comments_test --limit 5

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å–æ–±—Ä–∞–Ω—ã
sqlite3 raw_storage.sqlite "SELECT COUNT(*) FROM raw_messages WHERE message_type='comment'"
```

---

## üêõ –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–µ

### 1. FloodWaitError (Telegram rate limit)

```
telethon.errors.FloodWaitError: You must wait X seconds
```

**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–¥–æ–∂–¥–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è. Telegram –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤.

### 2. AuthKeyUnregisteredError

```
telethon.errors.AuthKeyUnregisteredError
```

**–†–µ—à–µ–Ω–∏–µ**: –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∑–∞–Ω–æ–≤–æ:
```bash
rm tg_parser_session.session
python -m tg_parser.cli ingest --source test --limit 1
```

### 3. ChannelPrivateError

```
telethon.errors.ChannelPrivateError: The channel specified is private
```

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–∞–Ω–∞–ª –∏–ª–∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª.

### 4. OpenAI AuthenticationError

```
openai.AuthenticationError: Invalid API Key
```

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å OPENAI_API_KEY –≤ .env —Ñ–∞–π–ª–µ.

### 5. –ü—É—Å—Ç–æ–π –≤—ã–≤–æ–¥ –ø—Ä–∏ export

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —ç—Ç–∞–ø—ã pipeline.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `run` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤:
```bash
python -m tg_parser.cli run --source my_channel --out ./output
```

### 6. –û—à–∏–±–∫–∏ JSON –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç LLM

```
json.JSONDecodeError: Expecting value
```

**–ü—Ä–∏—á–∏–Ω–∞**: LLM –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON.

**–†–µ—à–µ–Ω–∏–µ**: 
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã –≤ `tg_parser/processing/prompts.py`
2. –î–æ–±–∞–≤–∏—Ç—å retry logic (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
export LOG_LEVEL=DEBUG

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ª–æ–≥–∞–º–∏
python -m tg_parser.cli run --source test --out ./output 2>&1 | tee run.log
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –≤ SQLite

```bash
# Raw —Å–æ–æ–±—â–µ–Ω–∏—è
sqlite3 raw_storage.sqlite "SELECT source_ref, message_type, created_at FROM raw_messages LIMIT 5"

# –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
sqlite3 processing_storage.sqlite "SELECT id, channel_id FROM processed_documents LIMIT 5"

# –¢–µ–º—ã
sqlite3 processing_storage.sqlite "SELECT id, title FROM topic_cards LIMIT 5"

# –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
sqlite3 processing_storage.sqlite "SELECT source_ref, error_message FROM processing_failures"
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è ingestion

```bash
sqlite3 ingestion_state.sqlite "SELECT source_id, last_post_id, status FROM sources"
```

---

## üìã –¢–≤–æ—è —Ä–æ–ª—å (Testing Agent)

> –¢—ã –∞–≥–µ–Ω—Ç-—Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ TG_parser.  
> –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º Telegram –∫–∞–Ω–∞–ª–µ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏.  
> –¢—ã –º–æ–∂–µ—à—å:
> - –ò–∑–º–µ–Ω—è—Ç—å –∫–æ–¥ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
> - –î–æ–±–∞–≤–ª—è—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
> - –£–ª—É—á—à–∞—Ç—å error handling
> - –î–æ–±–∞–≤–ª—è—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö edge cases
>
> –¢—ã –ù–ï –¥–æ–ª–∂–µ–Ω:
> - –ú–µ–Ω—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–µ–∑ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è
> - –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–∫—Ä–æ–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
> - –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å `pytest` (85+ —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `ruff format .` –∏ `ruff check .`
- ‚úÖ –°–ª–µ–¥–æ–≤–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º –∏–∑ `docs/contracts/*.schema.json`
- ‚úÖ –°–æ–±–ª—é–¥–∞—Ç—å –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (TR-8, TR-22, TR-41, TR-IF-4, TR-63)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏ –∏ –∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚ùå –ù–ï –º–µ–Ω—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–µ–∑ ADR
- ‚ùå –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å .env —Ñ–∞–π–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ credentials

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# 1. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cd /Users/alexanderefimov/TG_parser
source .venv/bin/activate

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å unit —Ç–µ—Å—Ç—ã
pytest

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env (—Å–º. –≤—ã—à–µ)
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env

# 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î
python -m tg_parser.cli init

# 5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª
python -m tg_parser.cli add-source --source-id test --channel-id @durov

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π pipeline —Å –ª–∏–º–∏—Ç–æ–º
python -m tg_parser.cli run --source test --out ./output --limit 5

# 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
cat ./output/kb_entries.ndjson | head -1 | python -m json.tool
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Telethon —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–±–æ—Ä –ø–æ—Å—Ç–æ–≤ –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–±–æ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –∫–∞–Ω–∞–ª –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)
- [ ] Processing —á–µ—Ä–µ–∑ OpenAI —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Topicization —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Export —Å–æ–∑–¥–∞—ë—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã
- [ ] Incremental —Ä–µ–∂–∏–º —Å–æ–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã
- [ ] Error handling –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
- [ ] Retry logic —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –∫–∞–Ω–∞–ª –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–î–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ç–µ—Å—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- `@durov` ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª –ü–∞–≤–ª–∞ –î—É—Ä–æ–≤–∞ (–ø—É–±–ª–∏—á–Ω—ã–π, –Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä—ë–º)
- –õ—é–±–æ–π –¥—Ä—É–≥–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–∞–Ω–∞–ª —Å –Ω–µ–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å—Ç–æ–≤

**–ò–∑–±–µ–≥–∞–π—Ç–µ**:
- –ö–∞–Ω–∞–ª—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–µ–¥–∏–∞ (–∑–∞–º–µ–¥–ª—è–µ—Ç ingestion)
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (—Ç—Ä–µ–±—É—é—Ç –ø–æ–¥–ø–∏—Å–∫—É)
- –ö–∞–Ω–∞–ª—ã —Å –æ–≥—Ä–æ–º–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (rate limits)

---

**–í–æ–ø—Ä–æ—Å—ã?** –í—Å–µ –¥–µ—Ç–∞–ª–∏ –≤ `docs/notes/SESSION_HANDOFF.md`

**–ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å?** –°–∫–∞–∂–∏ "–Ω–∞—á–∏–Ω–∞—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" –∏ –ø—Ä–∏—Å—Ç—É–ø–∞–π! üß™
