# TG_parser – Архитектура

## Цель

TG_parser предназначен для:
- сбора сообщений из Telegram‑каналов;
- обработки и структурирования информации с помощью ИИ;
- пополнения тематической базы знаний (knowledge base).

## Высокоуровневый обзор

Основные подсистемы:
- **Ingestion (Telegram)** – получение сырых сообщений из каналов;
- **Processing (LLM)** – очистка текста, нормализация, извлечение структуры и смысловых сущностей;
- **Storage / Knowledge Base** – сохранение документов и индексов для последующего поиска/аналитики;
- **Interfaces / Tools** – CLI/GUI/сервисы, использующие базу знаний.

Поток данных (упрощённо):
Telegram Channel → `RawTelegramMessage` → `ProcessedDocument` → `KnowledgeBaseEntry` → запросы к базе знаний.

## Модули

### Ingestion (Telegram)
- Интеграция с Telegram API/клиентом.
- Планирование и повторный запуск задач сбора.
- Дедупликация и идемпотентность.
- Выходные данные: объекты `RawTelegramMessage` (см. `docs/contracts/raw_telegram_message.schema.json`).

### Processing / LLM
- Препроцессинг сообщений (очистка, нормализация, разбиение).
- Запросы к LLM/классификаторам.
- Формирование структурированных `ProcessedDocument`.

### Storage / Knowledge Base
- Схема хранения для `KnowledgeBaseEntry`.
- Механизм upsert/версионирования и обновления индексов (например, векторный поиск).

### Observability и управление
- Логирование ключевых шагов пайплайна.
- Метрики (объём, задержка, ошибки).
- Конфигурация моделей, лимитов Telegram, параметров шедулера.

## Нефункциональные требования (черновик)

- Масштабируемость по числу каналов и объёму истории.
- Минимизация потерь сообщений (надёжная обработка ошибок и ретраи).
- Прозрачность работы: логи, метрики, возможность аудита источников.
- Чёткие интерфейсы между модулями (контракты в `docs/contracts/`).


